/*
 *  tracking.js - v0.0.1
 *  Augmented Reality JavaScript Framework
 *  https://github.com/eduardolundgren/tracking.js/

 *  Copyright (c) 2013
 *  BSD License
 */(function(){var t=tracking.isString,e=tracking.math.distance;tracking.type.COLOR={NAME:"COLOR",defaults:{color:"magenta",minFoundPixels:30},cyan:function(t,e,n){var a=50,r=50,i=t-0,o=e-255,s=n-255;return e-t>=a&&n-t>=r?!0:80>Math.sqrt(i*i+o*o+s*s)},magenta:function(t,e,n){var a=50,r=t-255,i=e-0,o=n-255;return t-e>=a&&n-e>=a?!0:140>Math.sqrt(r*r+i*i+o*o)},yellow:function(t,e,n){var a=50,r=t-255,i=e-255,o=n-0;return t-e>=a&&n-e>=a?!0:100>Math.sqrt(r*r+i*i+o*o)},findCoordinates_:function(t,e){var n,a,r,i=0,o=0,s=0,c=1/0,u=1/0,l=-1,m=-1;for(r=0;e>r;r+=2)n=t[r],a=t[r+1],n>-1&&a>-1&&(i+=n,o+=a,s++,c>n&&(c=n),n>l&&(l=n),u>a&&(u=a),a>m&&(m=a));return{x:i/s,y:o/s,z:60-(l-c+(m-u))/2}},flagOutliers_:function(t,n){var a,r,i;for(r=0;n>r;r+=2){for(a=0,i=2;n>i;i+=2)a+=e(t[r],t[r+1],t[i],t[i+1]);a/n>30&&(t[r]=-1,t[r+1]=-1,n[r]--)}},track:function(e,n){var a,r,i,o,s=this,c=s.defaults,u=[],l=[];for(n.canvas.forEach(n.getVideoCanvasImageData(),function(n,i,m,h,d,f,g){for(r=-1;a=e[++r];)l[r]||(u[r]=0,l[r]=[]),o=a.color||c.color,t(o)&&s.hasOwnProperty(o)&&(o=s[o]),o.call(s,n,i,m,h,d,f,g)&&(u[r]+=2,l[r].push(g,f))}),r=-1;a=e[++r];)u[r]<=c.minFoundPixels?a.onNotFound&&a.onNotFound.call(n,i):(s.flagOutliers_(l[r],u[r]),i=s.findCoordinates_(l[r],u[r]),i.pixels=l[r],a.onFound&&a.onFound.call(n,i))}}})(window);